<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Orthogonalizing EM • oem</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">oem</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/oem_vignette.html">Intro</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jaredhuling/oem">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">

<div id="build-status" class="section level3">
<h3 class="hasAnchor">
<a href="#build-status" class="anchor"></a>Build Status</h3>
<table class="table">
<thead><tr class="header">
<th>OS</th>
<th>Build</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Linux x86_64 / OSX</td>
<td><a href="https://travis-ci.org/jaredhuling/oem"><img src="https://travis-ci.org/jaredhuling/oem.svg?branch=master" alt="Build Status"></a></td>
</tr>
<tr class="even">
<td>Windows x86_64</td>
<td><a href="https://ci.appveyor.com/project/jaredhuling/oem"><img src="https://ci.appveyor.com/api/projects/status/github/jaredhuling/oem?branch=master&amp;svg=true" alt="Appveyor Build Status"></a></td>
</tr>
</tbody>
</table>
</div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The oem package provides estimaton for various penalized linear models using the <a href="http://amstat.tandfonline.com/doi/abs/10.1080/00401706.2015.1054436">Orthogonalizing EM algorithm</a>. Documentation for the package can be found here: <a href="http://casualinference.org/oem">oem site</a> (still under construction).</p>
<p>Install using the <strong>devtools</strong> package (RcppEigen must be installed first as well):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"jaredhuling/oem"</span>)</code></pre></div>
<p>or by cloning and building using <code>R CMD INSTALL</code></p>
</div>
<div id="models" class="section level2">
<h2 class="hasAnchor">
<a href="#models" class="anchor"></a>Models</h2>
<div id="lasso" class="section level3">
<h3 class="hasAnchor">
<a href="#lasso" class="anchor"></a>Lasso</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(microbenchmark)
<span class="kw">library</span>(glmnet)
<span class="kw">library</span>(oem)
<span class="co"># compute the full solution path, n &gt; p</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
n &lt;-<span class="st"> </span><span class="dv">1000000</span>
p &lt;-<span class="st"> </span><span class="dv">100</span>
m &lt;-<span class="st"> </span><span class="dv">25</span>
b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">runif</span>(m), <span class="kw">rep</span>(<span class="dv">0</span>, p <span class="op">-</span><span class="st"> </span>m)))
x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>p, <span class="dt">sd =</span> <span class="dv">3</span>), n, p)
y &lt;-<span class="st"> </span><span class="kw">drop</span>(x <span class="op">%*%</span><span class="st"> </span>b) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)

lambdas =<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y, <span class="dt">intercept =</span> <span class="ot">TRUE</span>, <span class="dt">standardize =</span> <span class="ot">FALSE</span>, <span class="dt">penalty =</span> <span class="st">"elastic.net"</span>)<span class="op">$</span>lambda[[<span class="dv">1</span>]]

<span class="kw">microbenchmark</span>(
    <span class="st">"glmnet[lasso]"</span> =<span class="st"> </span>{res1 &lt;-<span class="st"> </span><span class="kw">glmnet</span>(x, y, <span class="dt">thresh =</span> <span class="fl">1e-10</span>, 
                                      <span class="dt">standardize =</span> <span class="ot">FALSE</span>,
                                      <span class="dt">intercept =</span> <span class="ot">TRUE</span>,
                                      <span class="dt">lambda =</span> lambdas)}, 
    <span class="st">"oem[lasso]"</span>    =<span class="st"> </span>{res2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y,
                                   <span class="dt">penalty =</span> <span class="st">"elastic.net"</span>,
                                   <span class="dt">intercept =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">standardize =</span> <span class="ot">FALSE</span>,
                                   <span class="dt">lambda =</span> lambdas,
                                   <span class="dt">tol =</span> <span class="fl">1e-10</span>)},
    <span class="dt">times =</span> <span class="dv">5</span>
)</code></pre></div>
<pre><code>## Unit: seconds
##           expr      min       lq     mean   median       uq      max neval
##  glmnet[lasso] 7.568786 7.682571 7.868538 7.804442 8.002525 8.284365     5
##     oem[lasso] 1.988946 2.020569 2.144351 2.130597 2.261201 2.320442     5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># difference of results</span>
<span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(res1) <span class="op">-</span><span class="st"> </span>res2<span class="op">$</span>beta[[<span class="dv">1</span>]]))</code></pre></div>
<pre><code>## [1] 1.048072e-07</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res1 &lt;-<span class="st"> </span><span class="kw">glmnet</span>(x, y, <span class="dt">thresh =</span> <span class="fl">1e-12</span>, 
               <span class="dt">standardize =</span> <span class="ot">FALSE</span>,
               <span class="dt">intercept =</span> <span class="ot">TRUE</span>,
               <span class="dt">lambda =</span> lambdas)

<span class="co"># answers are now more close once we require more precise glmnet solutions</span>
<span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">coef</span>(res1) <span class="op">-</span><span class="st"> </span>res2<span class="op">$</span>beta[[<span class="dv">1</span>]]))</code></pre></div>
<pre><code>## [1] 3.763397e-09</code></pre>
</div>
<div id="nonconvex-penalties" class="section level3">
<h3 class="hasAnchor">
<a href="#nonconvex-penalties" class="anchor"></a>Nonconvex Penalties</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sparsenet)
<span class="kw">library</span>(ncvreg)
<span class="kw">library</span>(plus)
<span class="co"># compute the full solution path, n &gt; p</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
n &lt;-<span class="st"> </span><span class="dv">5000</span>
p &lt;-<span class="st"> </span><span class="dv">200</span>
m &lt;-<span class="st"> </span><span class="dv">25</span>
b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">runif</span>(m, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="kw">rep</span>(<span class="dv">0</span>, p <span class="op">-</span><span class="st"> </span>m)))
x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>p, <span class="dt">sd =</span> <span class="dv">3</span>), n, p)
y &lt;-<span class="st"> </span><span class="kw">drop</span>(x <span class="op">%*%</span><span class="st"> </span>b) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)

mcp.lam &lt;-<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y, <span class="dt">penalty =</span> <span class="st">"mcp"</span>,
               <span class="dt">gamma =</span> <span class="dv">2</span>, <span class="dt">intercept =</span> <span class="ot">TRUE</span>, 
               <span class="dt">standardize =</span> <span class="ot">TRUE</span>,
               <span class="dt">nlambda =</span> <span class="dv">200</span>, <span class="dt">tol =</span> <span class="fl">1e-10</span>)<span class="op">$</span>lambda[[<span class="dv">1</span>]]

scad.lam &lt;-<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y, <span class="dt">penalty =</span> <span class="st">"scad"</span>,
               <span class="dt">gamma =</span> <span class="dv">4</span>, <span class="dt">intercept =</span> <span class="ot">TRUE</span>, 
               <span class="dt">standardize =</span> <span class="ot">TRUE</span>,
               <span class="dt">nlambda =</span> <span class="dv">200</span>, <span class="dt">tol =</span> <span class="fl">1e-10</span>)<span class="op">$</span>lambda[[<span class="dv">1</span>]]

<span class="kw">microbenchmark</span>(
    <span class="st">"sparsenet[mcp]"</span> =<span class="st"> </span>{res1 &lt;-<span class="st"> </span><span class="kw">sparsenet</span>(x, y, <span class="dt">thresh =</span> <span class="fl">1e-10</span>, 
                                          <span class="dt">gamma =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="co">#sparsenet throws an error </span>
                                                          <span class="co">#if you only fit 1 value of gamma</span>
                                          <span class="dt">nlambda =</span> <span class="dv">200</span>)},
    <span class="st">"oem[mcp]"</span>    =<span class="st"> </span>{res2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y,  
                                 <span class="dt">penalty =</span> <span class="st">"mcp"</span>,
                                 <span class="dt">gamma =</span> <span class="dv">2</span>,
                                 <span class="dt">intercept =</span> <span class="ot">TRUE</span>, 
                                 <span class="dt">standardize =</span> <span class="ot">TRUE</span>,
                                 <span class="dt">nlambda =</span> <span class="dv">200</span>,
                                 <span class="dt">tol =</span> <span class="fl">1e-10</span>)},
    <span class="st">"ncvreg[mcp]"</span>    =<span class="st"> </span>{res3 &lt;-<span class="st"> </span><span class="kw">ncvreg</span>(x, y,  
                                   <span class="dt">penalty =</span> <span class="st">"MCP"</span>,
                                   <span class="dt">gamma =</span> <span class="dv">2</span>,
                                   <span class="dt">lambda =</span> mcp.lam,
                                   <span class="dt">eps =</span> <span class="fl">1e-7</span>)}, 
    <span class="st">"plus[mcp]"</span>    =<span class="st"> </span>{res4 &lt;-<span class="st"> </span><span class="kw">plus</span>(x, y,  
                                   <span class="dt">method =</span> <span class="st">"mc+"</span>,
                                   <span class="dt">gamma =</span> <span class="dv">2</span>,
                                   <span class="dt">lam =</span> mcp.lam)},
    <span class="st">"oem[scad]"</span>    =<span class="st"> </span>{res5 &lt;-<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y,  
                                 <span class="dt">penalty =</span> <span class="st">"scad"</span>,
                                 <span class="dt">gamma =</span> <span class="dv">4</span>,
                                 <span class="dt">intercept =</span> <span class="ot">TRUE</span>, 
                                 <span class="dt">standardize =</span> <span class="ot">TRUE</span>,
                                 <span class="dt">nlambda =</span> <span class="dv">200</span>,
                                 <span class="dt">tol =</span> <span class="fl">1e-10</span>)},
    <span class="st">"ncvreg[scad]"</span>    =<span class="st"> </span>{res6 &lt;-<span class="st"> </span><span class="kw">ncvreg</span>(x, y,  
                                   <span class="dt">penalty =</span> <span class="st">"SCAD"</span>,
                                   <span class="dt">gamma =</span> <span class="dv">4</span>,
                                   <span class="dt">lambda =</span> scad.lam,
                                   <span class="dt">eps =</span> <span class="fl">1e-7</span>)}, 
    <span class="st">"plus[scad]"</span>    =<span class="st"> </span>{res7 &lt;-<span class="st"> </span><span class="kw">plus</span>(x, y,  
                                   <span class="dt">method =</span> <span class="st">"scad"</span>,
                                   <span class="dt">gamma =</span> <span class="dv">4</span>,
                                   <span class="dt">lam =</span> scad.lam)}, 
    <span class="dt">times =</span> <span class="dv">5</span>
)</code></pre></div>
<pre><code>## Warning message: some lam not reached by the plus path and dropped
## Warning message: some lam not reached by the plus path and dropped
## Warning message: some lam not reached by the plus path and dropped
## Warning message: some lam not reached by the plus path and dropped
## Warning message: some lam not reached by the plus path and dropped
## Warning message: some lam not reached by the plus path and dropped
## Warning message: some lam not reached by the plus path and dropped
## Warning message: some lam not reached by the plus path and dropped
## Warning message: some lam not reached by the plus path and dropped
## Warning message: some lam not reached by the plus path and dropped</code></pre>
<pre><code>## Unit: milliseconds
##            expr       min        lq      mean    median        uq
##  sparsenet[mcp] 1875.2452 1884.3615 1951.6725 1911.5395 1965.9868
##        oem[mcp]  159.7789  165.8270  168.1560  167.9728  172.5197
##     ncvreg[mcp] 7315.2545 7713.0761 8139.2804 8106.4046 8174.1345
##       plus[mcp] 1672.3138 1782.7750 1811.6840 1842.9139 1872.5081
##       oem[scad]  138.7133  140.0483  153.2491  147.7870  151.2243
##    ncvreg[scad] 7951.6813 8002.6719 8772.1703 8112.8205 8360.5586
##      plus[scad] 1926.4920 1970.5033 2210.5158 2196.7534 2355.7689
##         max neval
##   2121.2295     5
##    174.6816     5
##   9387.5322     5
##   1887.9093     5
##    188.4727     5
##  11433.1193     5
##   2603.0614     5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diffs &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))
<span class="kw">colnames</span>(diffs) &lt;-<span class="st"> "abs diff"</span>
<span class="kw">rownames</span>(diffs) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"MCP:  oem and ncvreg"</span>, <span class="st">"SCAD: oem and ncvreg"</span>,
                     <span class="st">"MCP:  oem and plus"</span>, <span class="st">"SCAD: oem and plus"</span>)
diffs[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">max</span>(<span class="kw">abs</span>(res2<span class="op">$</span>beta[[<span class="dv">1</span>]] <span class="op">-</span><span class="st"> </span>res3<span class="op">$</span>beta)), <span class="kw">max</span>(<span class="kw">abs</span>(res5<span class="op">$</span>beta[[<span class="dv">1</span>]] <span class="op">-</span><span class="st"> </span>res6<span class="op">$</span>beta)),
               <span class="kw">max</span>(<span class="kw">abs</span>(res2<span class="op">$</span>beta[[<span class="dv">1</span>]][<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(res4<span class="op">$</span>beta)] <span class="op">-</span><span class="st"> </span><span class="kw">t</span>(res4<span class="op">$</span>beta))),
               <span class="kw">max</span>(<span class="kw">abs</span>(res5<span class="op">$</span>beta[[<span class="dv">1</span>]][<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(res7<span class="op">$</span>beta)] <span class="op">-</span><span class="st"> </span><span class="kw">t</span>(res7<span class="op">$</span>beta))))
diffs</code></pre></div>
<pre><code>##                          abs diff
## MCP:  oem and ncvreg 1.725859e-07
## SCAD: oem and ncvreg 5.094648e-08
## MCP:  oem and plus   2.684136e-11
## SCAD: oem and plus   1.732409e-11</code></pre>
</div>
<div id="group-lasso" class="section level3">
<h3 class="hasAnchor">
<a href="#group-lasso" class="anchor"></a>Group Lasso</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gglasso)
<span class="kw">library</span>(grpreg)
<span class="kw">library</span>(grplasso)
<span class="co"># compute the full solution path, n &gt; p</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
n &lt;-<span class="st"> </span><span class="dv">10000</span>
p &lt;-<span class="st"> </span><span class="dv">200</span>
m &lt;-<span class="st"> </span><span class="dv">25</span>
b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">runif</span>(m, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="kw">rep</span>(<span class="dv">0</span>, p <span class="op">-</span><span class="st"> </span>m)))
x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>p, <span class="dt">sd =</span> <span class="dv">3</span>), n, p)
y &lt;-<span class="st"> </span><span class="kw">drop</span>(x <span class="op">%*%</span><span class="st"> </span>b) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)
groups &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">floor</span>(p<span class="op">/</span><span class="dv">10</span>), <span class="dt">each =</span> <span class="dv">10</span>)

grp.lam &lt;-<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y, <span class="dt">penalty =</span> <span class="st">"grp.lasso"</span>,
               <span class="dt">groups =</span> groups,
               <span class="dt">nlambda =</span> <span class="dv">100</span>, <span class="dt">tol =</span> <span class="fl">1e-10</span>)<span class="op">$</span>lambda[[<span class="dv">1</span>]]


<span class="kw">microbenchmark</span>(
    <span class="st">"gglasso[grp.lasso]"</span> =<span class="st"> </span>{res1 &lt;-<span class="st"> </span><span class="kw">gglasso</span>(x, y, <span class="dt">group =</span> groups, 
                                            <span class="dt">lambda =</span> grp.lam, 
                                            <span class="dt">intercept =</span> <span class="ot">FALSE</span>,
                                            <span class="dt">eps =</span> <span class="fl">1e-8</span>)},
    <span class="st">"oem[grp.lasso]"</span>    =<span class="st"> </span>{res2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y,  
                                       <span class="dt">groups =</span> groups,
                                       <span class="dt">intercept =</span> <span class="ot">FALSE</span>,
                                       <span class="dt">standardize =</span> <span class="ot">FALSE</span>,
                                       <span class="dt">penalty =</span> <span class="st">"grp.lasso"</span>,
                                       <span class="dt">lambda =</span> grp.lam,
                                       <span class="dt">tol =</span> <span class="fl">1e-10</span>)},
    <span class="st">"grplasso[grp.lasso]"</span>    =<span class="st"> </span>{res3 &lt;-<span class="st"> </span><span class="kw">grplasso</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, 
                                                 <span class="dt">index =</span> groups,
                                                 <span class="dt">standardize =</span> <span class="ot">FALSE</span>, 
                                                 <span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">model =</span> <span class="kw">LinReg</span>(), 
                                                 <span class="dt">lambda =</span> grp.lam <span class="op">*</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="dv">2</span>, 
                                                 <span class="dt">control =</span> <span class="kw">grpl.control</span>(<span class="dt">trace =</span> <span class="dv">0</span>, <span class="dt">tol =</span> <span class="fl">1e-10</span>))}, 
    <span class="st">"grpreg[grp.lasso]"</span>    =<span class="st"> </span>{res4 &lt;-<span class="st"> </span><span class="kw">grpreg</span>(x, y, <span class="dt">group =</span> groups, 
                                             <span class="dt">eps =</span> <span class="fl">1e-10</span>, <span class="dt">lambda =</span> grp.lam)},
    <span class="dt">times =</span> <span class="dv">5</span>
)</code></pre></div>
<pre><code>## Unit: milliseconds
##                 expr       min        lq      mean    median         uq
##   gglasso[grp.lasso] 3774.1569 3876.1610 4558.0958 3881.6797  5080.7715
##       oem[grp.lasso]  103.6529  117.1045  129.0256  117.2699   143.8689
##  grplasso[grp.lasso] 7836.8351 9834.3802 9782.8884 9879.5035 10593.6439
##    grpreg[grp.lasso] 1919.0754 2143.1892 2356.5680 2196.0299  2575.1049
##         max neval
##   6177.7100     5
##    163.2316     5
##  10770.0793     5
##   2949.4408     5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diffs &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">colnames</span>(diffs) &lt;-<span class="st"> "abs diff"</span>
<span class="kw">rownames</span>(diffs) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"oem and gglasso"</span>, <span class="st">"oem and grplasso"</span>)
diffs[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(  <span class="kw">max</span>(<span class="kw">abs</span>(res2<span class="op">$</span>beta[[<span class="dv">1</span>]][<span class="op">-</span><span class="dv">1</span>,] <span class="op">-</span><span class="st"> </span>res1<span class="op">$</span>beta)), <span class="kw">max</span>(<span class="kw">abs</span>(res2<span class="op">$</span>beta[[<span class="dv">1</span>]][<span class="op">-</span><span class="dv">1</span>,] <span class="op">-</span><span class="st"> </span>res3<span class="op">$</span>coefficients))  )
diffs</code></pre></div>
<pre><code>##                      abs diff
## oem and gglasso  1.303906e-06
## oem and grplasso 1.645871e-08</code></pre>
<div id="bigger-group-lasso-example" class="section level4">
<h4 class="hasAnchor">
<a href="#bigger-group-lasso-example" class="anchor"></a>Bigger Group Lasso Example</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
n &lt;-<span class="st"> </span><span class="dv">500000</span>
p &lt;-<span class="st"> </span><span class="dv">200</span>
m &lt;-<span class="st"> </span><span class="dv">25</span>
b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">runif</span>(m, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="kw">rep</span>(<span class="dv">0</span>, p <span class="op">-</span><span class="st"> </span>m)))
x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>p, <span class="dt">sd =</span> <span class="dv">3</span>), n, p)
y &lt;-<span class="st"> </span><span class="kw">drop</span>(x <span class="op">%*%</span><span class="st"> </span>b) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)
groups &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">floor</span>(p<span class="op">/</span><span class="dv">10</span>), <span class="dt">each =</span> <span class="dv">10</span>)

grp.penalties &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"grp.lasso"</span>, <span class="st">"grp.mcp"</span>, <span class="st">"grp.scad"</span>, 
                   <span class="st">"grp.mcp.net"</span>, <span class="st">"grp.scad.net"</span>,
                   <span class="st">"sparse.group.lasso"</span>)
<span class="kw">system.time</span>(res &lt;-<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y, 
                       <span class="dt">penalty =</span> grp.penalties,
                       <span class="dt">groups  =</span> groups,
                       <span class="dt">alpha   =</span> <span class="fl">0.25</span>, <span class="co"># mixing param for l2 penalties</span>
                       <span class="dt">tau     =</span> <span class="fl">0.5</span>)) <span class="co"># mixing param for sparse grp lasso </span></code></pre></div>
<pre><code>##    user  system elapsed 
##    3.87    0.22    4.68</code></pre>
</div>
</div>
<div id="fitting-multiple-penalties" class="section level3">
<h3 class="hasAnchor">
<a href="#fitting-multiple-penalties" class="anchor"></a>Fitting Multiple Penalties</h3>
<p>The oem algorithm is quite efficient at fitting multiple penalties simultaneously when p is not too big.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
n &lt;-<span class="st"> </span><span class="dv">100000</span>
p &lt;-<span class="st"> </span><span class="dv">100</span>
m &lt;-<span class="st"> </span><span class="dv">15</span>
b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">runif</span>(m, <span class="op">-</span><span class="fl">0.25</span>, <span class="fl">0.25</span>), <span class="kw">rep</span>(<span class="dv">0</span>, p <span class="op">-</span><span class="st"> </span>m)))
x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>p, <span class="dt">sd =</span> <span class="dv">3</span>), n, p)
y &lt;-<span class="st"> </span><span class="kw">drop</span>(x <span class="op">%*%</span><span class="st"> </span>b) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)

<span class="kw">microbenchmark</span>(
    <span class="st">"oem[lasso]"</span>    =<span class="st"> </span>{res1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y,
                                   <span class="dt">penalty =</span> <span class="st">"elastic.net"</span>,
                                   <span class="dt">intercept =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">standardize =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">tol =</span> <span class="fl">1e-10</span>)},
    <span class="st">"oem[lasso/mcp/scad/ols]"</span>    =<span class="st"> </span>{res2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/oem.html">oem</a></span>(x, y,
                                   <span class="dt">penalty =</span> <span class="kw">c</span>(<span class="st">"elastic.net"</span>, <span class="st">"mcp"</span>, 
                                               <span class="st">"scad"</span>, <span class="st">"grp.lasso"</span>, 
                                               <span class="st">"grp.mcp"</span>, <span class="st">"sparse.grp.lasso"</span>,
                                               <span class="st">"grp.mcp.net"</span>, <span class="st">"mcp.net"</span>),
                                   <span class="dt">gamma =</span> <span class="dv">4</span>,
                                   <span class="dt">tau =</span> <span class="fl">0.5</span>,
                                   <span class="dt">alpha =</span> <span class="fl">0.25</span>,
                                   <span class="dt">groups =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">each =</span> <span class="dv">10</span>),
                                   <span class="dt">intercept =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">standardize =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">tol =</span> <span class="fl">1e-10</span>)},
    <span class="dt">times =</span> <span class="dv">5</span>
)</code></pre></div>
<pre><code>## Unit: milliseconds
##                     expr      min       lq     mean   median       uq
##               oem[lasso] 216.5322 222.2787 224.1913 222.6778 228.1274
##  oem[lasso/mcp/scad/ols] 253.4806 270.0290 293.5199 273.7876 299.7562
##       max neval
##  231.3402     5
##  370.5461     5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#png("../mcp_path.png", width = 3000, height = 3000, res = 400);par(mar=c(5.1,5.1,4.1,2.1));plot(res2, which.model = 2, main = "mcp",lwd = 3,cex.axis=2.0, cex.lab=2.0, cex.main=2.0, cex.sub=2.0);dev.off()</span>
<span class="co">#</span>

<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))
<span class="kw">plot</span>(res2, <span class="dt">which.model =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,
     <span class="dt">xvar =</span> <span class="st">"lambda"</span>)
<span class="kw">plot</span>(res2, <span class="dt">which.model =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,
     <span class="dt">xvar =</span> <span class="st">"lambda"</span>)
<span class="kw">plot</span>(res2, <span class="dt">which.model =</span> <span class="dv">4</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,
     <span class="dt">xvar =</span> <span class="st">"lambda"</span>)
<span class="kw">plot</span>(res2, <span class="dt">which.model =</span> <span class="dv">7</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,
     <span class="dt">xvar =</span> <span class="st">"lambda"</span>)</code></pre></div>
<p><img src="articles/mult-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=oem">https://​cran.r-project.org/​package=oem</a>
</li>
<li>Browse source code at <br><a href="https://github.com/jaredhuling/oem">https://​github.com/​jaredhuling/​oem</a>
</li>
<li>Report a bug at <br><a href="https://github.com/jaredhuling/oem/issues">https://​github.com/​jaredhuling/​oem/​issues</a>
</li>
</ul>
<h2>License</h2>
<p>GPL (&gt;= 2)</p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Bin Dai <br><small class="roles"> Author </small> </li>
<li>Jared Huling <br><small class="roles"> Author, maintainer </small> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=oem"><img src="http://www.r-pkg.org/badges/version/oem" alt="version"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Bin Dai, Jared Huling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
